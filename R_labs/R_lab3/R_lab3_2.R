
# Лабораторная 3

setwd("C:/study/anatolich-1/R_labs/R_lab3/Workdir")

# Задание 2

# Проверка существования файла
if (file.exists("data.csv")) {
  # Чтение данных
  data <- read.table("data.csv", header = TRUE, sep = ";")
  
  # Очистка данных от NA
  cl_data <- na.omit(data)
  
  # Построение корреляционного поля
  plot(data$Математика, data$Обществознание, 
       main = "Корреляционное поле: Математика vs Обществознание", 
       xlab = "Баллы по математике", 
       ylab = "Баллы по обществознанию", 
       pch = 19, col = "blue")
  
  # Линейная регрессия: баллы по математике на баллы по обществознанию
  model1 <- lm(Математика ~ Обществознание, data = data)
  abline(model1, col = "red", lwd = 2)
  
  # Линейная регрессия: баллы по обществознанию на баллы по математике
  model2 <- lm(Обществознание ~ Математика, data = data)
  abline(model2, col = "green", lwd = 2)
  
  # Добавление легенды
  legend("topright", legend = c("Регрессия: Математика на Обществознание", 
                                "Регрессия: Обществознание на Математику"), 
         col = c("red", "green"), lwd = 2)
  
} else {
  cat("Файл 'data.csv' не найден по указанному пути.\n")
}